<!-- manual page source format generated by PolyglotMan v3.0.9, -->
<!-- available via anonymous ftp from ftp.cs.berkeley.edu:/ucb/people/phelps/tcltk/rman.tar.Z -->

<HTML>
<HEAD>
<TITLE>TCPTRACEROUTE(8) manual page</TITLE>
</HEAD>
<BODY bgcolor=white>
<A HREF="#toc">Table of Contents</A><P>

<H2><A NAME="sect0" HREF="#toc0">rcsE</A></H2>
tcptraceroute - A traceroute implementation using TCP packets 
<H2><A NAME="sect1" HREF="#toc1">rcsOrcsS</A></H2>
<B>tcptraceroute
[-nNFSAE] [ -i</B> <I>interface</I> <B>] [ -f</B> <I>first</I> ttl  <B>]</B> <BR>
<B>[ -l</B> <I>length</I> <B>] [ -q</B> <I>number</I> of queries <B>] [ -t</B> <I>tos</I> <B>]</B> <BR>
<B>[ -m</B> <I>max</I> ttl <B>] [ -p</B> <I>source</I> port <B>] [ -s</B> <I>source</I> address <B>]</B> <BR>
<B>[ -w</B> <I>wait</I> time <B>]</B> <I>host</I> <B>[</B> <I>destination</I> port <B>]</B> <B>[</B> <I>length</I> <B>]</B> 
<H2><A NAME="sect2" HREF="#toc2">rcsCrcsTrcs</A></H2>
<B>tcptraceroute</B>
is a traceroute implementation using TCP packets. <P>
The more traditional <I><I>traceroute</I>(8)</I>
sends out either UDP or ICMP ECHO packets with a TTL of one, and increments
the TTL until the destination has been reached.  By printing the gateways
that generate ICMP time exceeded messages along the way, it is able to
determine the path packets are taking to reach the destination. <P>
The problem
is that with the widespread use of firewalls on the modern Internet, many
of the packets that <I><I>traceroute</I>(8)</I> sends out end up being filtered, making
it impossible to completely trace the path to the destination.  However,
in many cases, these firewalls will permit inbound TCP packets to specific
ports that hosts sitting behind the firewall are listening for connections
on.  By sending out TCP SYN packets instead of UDP or ICMP ECHO packets,
<B>tcptraceroute</B> is able to bypass the most common firewall filters. <P>
It is
worth noting that  <B>tcptraceroute</B> never completely establishes a TCP connection
with the destination host. If the host is not listening for incoming connections,
it will respond with an RST indicating that the port is closed.  If the
host instead responds with a SYN|ACK, the port is known to be open, and
an RST is sent by the kernel <B>tcptraceroute</B> is running on to tear down the
connection without completing three-way handshake.  This is the same half-open
scanning technique that <I><I>nmap</I>(1)</I> uses when passed the <B>-sS</B> flag. 
<H2><A NAME="sect3" HREF="#toc3">rcsIrcs</A></H2>

<DL>

<DT>-n</DT>
<DD>Display
numeric output, rather than doing a reverse DNS lookup for each hop. By
default, reverse lookups are never attempted on RFC1918 address space,
regardless of the -n flag. </DD>

<DT>-N</DT>
<DD>Perform a reverse DNS lookup for each hop, including
RFC1918 addresses. </DD>

<DT>-f</DT>
<DD>Set the initial TTL used in the first outgoing packet.
 The default is 1. </DD>

<DT>-m</DT>
<DD>Set the maximum TTL used in outgoing packets.  The default
is 30. </DD>

<DT>-p</DT>
<DD>Use the specified local TCP port in outgoing packets.  The default
is to obtain a free port from the kernel using <I><I>bind</I>(2)</I>. Unlike with traditional
<I><I>traceroute</I>(8)</I>, this number will not increase with each hop. </DD>

<DT>-s</DT>
<DD>Set the source
address for outgoing packets.  See also the -i flag. </DD>

<DT>-i</DT>
<DD>Use the specified interface
for outgoing packets. </DD>

<DT>-q</DT>
<DD>Set the number of probes to be sent to each hop. 
The default is 3. </DD>

<DT>-w</DT>
<DD>Set the timeout, in seconds, to wait for a response for
each probe.  The default is 3. </DD>

<DT>-S</DT>
<DD>Set the TCP SYN flag in outgoing packets.
 This is the default, if neither -S or -A is specified. </DD>

<DT>-A</DT>
<DD>Set the TCP ACK flag
in outgoing packets.  By doing so, it is possible to trace through stateless
firewalls which permit outgoing TCP connections. </DD>

<DT>-E</DT>
<DD>Send ECN SYN packets,
as described in RFC2481. </DD>

<DT>-t</DT>
<DD>Set the IP TOS (type of service) to be used in
outgoing packets.  The default is not to set any TOS. </DD>

<DT>-F</DT>
<DD>Set the IP "don't fragment"
bit in outgoing packets. </DD>

<DT>-l</DT>
<DD>Set the total packet length to be used in outgoing
packets.  If the length is greater than the minimum size required to assemble
the necessary probe packet headers, this value is automatically increased.
</DD>

<DT>-d</DT>
<DD>Enable debugging, which may or may not be useful. </DD>
</DL>

<H2><A NAME="sect4" HREF="#toc4">rcsMrcsS</A></H2>
Please see the
<I>examples.txt</I> file included in the <B>tcptraceroute</B> distribution for a few real
world examples. <P>
To trace the path to a web server listening for connections
on port 80: <P>
<blockquote><B>tcptraceroute webserver</B> </blockquote>
<P>
To trace the path to a mail server
listening for connections on port 25: <P>
<blockquote><B>tcptraceroute mailserver 25</B> </blockquote>

<H2><A NAME="sect5" HREF="#toc5">rcsS</A></H2>
No
error checking is performed on the source address specified by the -s flag,
and it is therefore possible for  <B></B> tcptraceroute to send out TCP SYN packets
for which it has no chance of seeing a response to. 
<H2><A NAME="sect6" HREF="#toc6">rcsHrcs rcs rcs rcskrcs
rcs rcscrcst rcs rcscrcscrcsf rcsircsa rcsprcse</A></H2>
Michael C. Toren &lt;mct@toren.net&gt;

<H2><A NAME="sect7" HREF="#toc7">rcsIrcsIrcsY</A></H2>
For updates, please see: <BR>
<blockquote><I>http://michael.toren.net/code/tcptraceroute/</I> </blockquote>

<H2><A NAME="sect8" HREF="#toc8">rcs rcsO</A></H2>
<I><I>traceroute</I>(8)</I>, <I><I>ping</I>(8)</I>,
<I><I>nmap</I>(1)</I> <P>

<HR><P>
<A NAME="toc"><B>Table of Contents</B></A><P>
<UL>
<LI><A NAME="toc0" HREF="#sect0">rcsE</A></LI>
<LI><A NAME="toc1" HREF="#sect1">rcsOrcsS</A></LI>
<LI><A NAME="toc2" HREF="#sect2">rcsCrcsTrcs</A></LI>
<LI><A NAME="toc3" HREF="#sect3">rcsIrcs</A></LI>
<LI><A NAME="toc4" HREF="#sect4">rcsMrcsS</A></LI>
<LI><A NAME="toc5" HREF="#sect5">rcsS</A></LI>
<LI><A NAME="toc6" HREF="#sect6">rcsHrcs rcs rcs rcskrcs rcs rcscrcst rcs rcscrcscrcsf rcsircsa rcsprcse</A></LI>
<LI><A NAME="toc7" HREF="#sect7">rcsIrcsIrcsY</A></LI>
<LI><A NAME="toc8" HREF="#sect8">rcs rcsO</A></LI>
</UL>
</BODY></HTML>
